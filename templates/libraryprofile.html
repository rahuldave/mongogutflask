{% extends "layout.html" %}
{% block body %}
<h3>Library {{thelibrary.basic.fqin}}</h3>
  <!--iframe width="100%" src="/library/{{ thelibrary.basic.fqin}}"></iframe-->
  <div id="info" style="display:none"></div>
  <hr/>
  <h4>Members</h4>
  <!--iframe width="100%" src="/library/{{ thelibrary.basic.fqin}}/members"></iframe-->
  <div id="members" style="display:none"></div>
  {% if owner %}
  <h4>Invitations</h4>
  <div id="invitedform" style="display:none"></div>
  <div id="inviteds" style="display:none"></div>
  {% endif %}
{% endblock %}
{% block coffeescript %}
$=jQuery
$ -> 
  console?.log "Hello World"
  model={}
  $.get "/library/{{ thelibrary.basic.fqin}}", (data) ->
    console?.log data
    content=views.library_info data, templates.library_info
    $('div#info').append(content)
    $('div#info').show()
  $.get "/library/{{ thelibrary.basic.fqin}}/members", (data) ->
    content=views.postable_members "{{owner}}", data, templates.postable_members
    $('div#members').append(content)
    $('div#members').show()
  {% if owner %}
  view=new views.InviteUser(model, {postable: "{{ thelibrary.basic.fqin}}", withcb:true})
  $('div#invitedform').append(view.render().$el)

  view=new views.AddGroup(model, {postable: "{{ thelibrary.basic.fqin}}", groups:['rahuldave/group:ml','jayluker:/group:sp'], withcb:true} )
  $('div#invitedform').append(view.render().$el)
  $('div#invitedform').show()
  $.get "/library/{{ thelibrary.basic.fqin}}/inviteds", (data) ->
    content=views.postable_inviteds data, templates.postable_inviteds
    $('div#inviteds').append(content)
    $('div#inviteds').show()
  {% endif %}
{% endblock %}